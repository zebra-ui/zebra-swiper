import{L as e,A as t,p as s,m as a,j as l,k as i,o as r,c as d,w as n,a as u,d as o,r as c,F as p,i as v}from"./index-Cfs_Z2UQ.js";function f({swiper:a,extendParams:l,on:i,emit:r}){let d;function n(e,t){const l=a.params.virtual;if(l.cache&&a.virtual.cache[t])return a.virtual.cache[t];let i;if(l.renderSlide){if(i=l.renderSlide.call(a,e,t),"string"==typeof i){const e=document.createElement("div");e.innerHTML=i,i=e.children[0]}}else i=a.isElement?s("swiper-slide"):s("div",a.params.slideClass);return i.setAttribute("data-swiper-slide-index",String(t)),l.renderSlide||(i.innerHTML=e),l.cache&&(a.virtual.cache[t]=i),i}function u(e,s){var l,i,d;const{slidesPerView:u,slidesPerGroup:o,centeredSlides:c,loop:p,initialSlide:v}=a.params;if(s&&!p&&v>0)return;const{addSlidesBefore:f,addSlidesAfter:h}=a.params.virtual,{from:m,to:x,slides:g,slidesGrid:w,offset:E,data:b}=a.virtual;a.params.cssMode||a.updateActiveIndex();const y=a.activeIndex||0;let S,A,M;S=a.rtlTranslate?"right":a.isHorizontal()?"left":"top",c?(A=Math.floor(u/2)+o+h,M=Math.floor(u/2)+o+f):(A=u+o-1+h,M=(p?u:o)+f);let I=y-M,j=y+A;p||(I=Math.max(I,0),j=Math.min(j,g.length-1));let G=(a.slidesGrid[I]||0)-(a.slidesGrid[0]||0);function _(){a.updateSlides(),a.updateProgress(),a.updateSlidesClasses(),r("virtualUpdate")}if(p&&y>=M?(I-=M,c||(G+=a.slidesGrid[0])):p&&y<M&&(I=-M,c&&(G+=a.slidesGrid[0])),Object.assign(a.virtual,{from:I,to:j,offset:G,slidesGrid:a.slidesGrid,slidesBefore:M,slidesAfter:A}),m===I&&x===j&&!e)return a.slidesGrid!==w&&G!==E&&a.slides.forEach((e=>{e.style[S]=G-Math.abs(a.cssOverflowAdjustment())+"px"})),a.updateProgress(),void r("virtualUpdate");if(null==(l=a.params.virtual)?void 0:l.renderExternal)return null==(i=a.params.virtual.renderExternal)||i.call(a,{offset:G,from:I,to:j,slides:function(){const e=[];for(let t=I;t<=j;t+=1)e.push(g[t]);return e}(),data:function(){const e=[];for(let t=I;t<=j;t+=1)e.push(b[t]);return e}()}),void((null==(d=a.params.virtual)?void 0:d.renderExternalUpdate)?_():r("virtualUpdate"));const k=[],P=[],T=e=>{let t=e;return e<0?t=g.length+e:t>=g.length&&(t-=g.length),t};if(e)a.slides.filter((e=>e.matches(`.${a.params.slideClass}, swiper-slide`))).forEach((e=>{e.remove()}));else for(let t=m;t<=x;t+=1)if(t<I||t>j){const e=T(t);a.slides.filter((t=>t.matches(`.${a.params.slideClass}[data-swiper-slide-index="${e}"], swiper-slide[data-swiper-slide-index="${e}"]`))).forEach((e=>{e.remove()}))}const $=p?-g.length:0,L=p?2*g.length:g.length;for(let t=$;t<L;t+=1)if(t>=I&&t<=j){const s=T(t);void 0===x||e?P.push(s):(t>x&&P.push(s),t<m&&k.push(s))}if(P.forEach((e=>{a.slidesEl.append(n(g[e],e))})),p)for(let t=k.length-1;t>=0;t-=1){const e=k[t];a.slidesEl.prepend(n(g[e],e))}else k.sort(((e,t)=>t-e)),k.forEach((e=>{a.slidesEl.prepend(n(g[e],e))}));t(a.slidesEl,".swiper-slide, swiper-slide").forEach((e=>{e.style[S]=G-Math.abs(a.cssOverflowAdjustment())+"px"})),_()}l({virtual:{enabled:!1,slides:[],data:[],cache:!0,renderSlide:null,renderExternal:null,renderExternalUpdate:!0,addSlidesBefore:0,addSlidesAfter:0}}),a.virtual={cache:{},from:void 0,to:void 0,slides:[],data:[],offset:0,slidesGrid:[]},i("beforeInit",(()=>{var e;if(!a.params.virtual.enabled)return;let t;if(void 0===(null==(e=a.passedParams.virtual)?void 0:e.slides)){const e=Array.from(a.slidesEl.children).filter((e=>e.matches(`.${a.params.slideClass}, swiper-slide`)));e&&e.length&&(t=!0,e.forEach(((e,t)=>{e.setAttribute("data-swiper-slide-index",String(t)),a.virtual.cache[t]=e,e.remove()})))}t||(a.virtual.slides=a.params.virtual.slides||[]),a.classNames.push(`${a.params.containerModifierClass}virtual`),a.params.watchSlidesProgress=!0,a.originalParams.watchSlidesProgress=!0,u(!1,!0)})),i("setTranslate",(()=>{a.params.virtual.enabled&&(a.params.cssMode&&!a._immediateVirtual?(clearTimeout(d),d=setTimeout((()=>{u()}),100)):u())})),i("init update resize",(()=>{a.params.virtual.enabled&&a.params.cssMode&&e(a.wrapperEl,"--swiper-virtual-size",`${a.virtualSize}px`)})),Object.assign(a.virtual,{appendSlide:function(e){if("object"==typeof e&&"length"in e)for(let t=0;t<e.length;t+=1)e[t]&&a.virtual.slides.push(e[t]);else a.virtual.slides.push(e);u(!0)},prependSlide:function(e){const{activeIndex:t}=a;let s=t+1,l=1;if(Array.isArray(e)){for(let t=0;t<e.length;t+=1)e[t]&&a.virtual.slides.unshift(e[t]);s=t+e.length,l=e.length}else a.virtual.slides.unshift(e);if(a.params.virtual.cache){const{cache:e}=a.virtual,t={};Object.keys(e).forEach((s=>{const a=e[s],i=a.getAttribute("data-swiper-slide-index");i&&a.setAttribute("data-swiper-slide-index",String(Number(i)+l)),t[Number(s)+l]=a})),a.virtual.cache=t}u(!0),a.slideTo(s,0)},removeSlide:function(e){if(null==e)return;let{activeIndex:t}=a;if(Array.isArray(e))for(let s=e.length-1;s>=0;s-=1)a.params.virtual.cache&&(delete a.virtual.cache[e[s]],Object.keys(a.virtual.cache).forEach((e=>{e>slidesIndexes&&(a.virtual.cache[e-1]=a.virtual.cache[e],a.virtual.cache[e-1].setAttribute("data-swiper-slide-index",e-1),delete a.virtual.cache[e])}))),a.virtual.slides.splice(e[s],1),e[s]<t&&(t-=1),t=Math.max(t,0);else a.params.virtual.cache&&(delete a.virtual.cache[e],Object.keys(a.virtual.cache).forEach((e=>{e>slidesIndexes&&(a.virtual.cache[e-1]=a.virtual.cache[e],a.virtual.cache[e-1].setAttribute("data-swiper-slide-index",e-1),delete a.virtual.cache[e])}))),a.virtual.slides.splice(e,1),e<t&&(t-=1),t=Math.max(t,0);u(!0),a.slideTo(t,0)},removeAllSlides:function(){a.virtual.slides=[],a.params.virtual.cache&&(a.virtual.cache={}),u(!0),a.slideTo(0,0)},update:u})}const h=a({__name:"index",setup(e){const t=l([f]),s=["#7ED321","#2183D3","#2128D3","#431058","#1E835A","#B1397B","#B36021"],a=l([]),h=l([]),m=l(Array.from({length:1e3}).map(((e,t)=>{const a=Math.floor(7*Math.random());return{id:g(),background:s[a],text:`slide${t}`}}))),x=l(Array.from({length:1e3}).map(((e,t)=>{const a=Math.floor(7*Math.random());return{id:g(),background:s[a],text:`slide${t}`}})));function g(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}return(e,s)=>{const l=i("demo-item"),f=i("z-swiper-item"),g=i("z-swiper"),w=i("demo-block"),E=v;return r(),d(E,{class:"demo-swiper"},{default:n((()=>[u(w,{title:"基础用法"},{default:n((()=>[u(g,{list:a.value,"onUpdate:list":s[0]||(s[0]=e=>a.value=e),virtual:"",modules:t.value,virtualList:m.value},{default:n((()=>[(r(!0),o(p,null,c(a.value,((e,t)=>(r(),d(f,{key:t,virtualIndex:e.virtualIndex,"custom-style":e.props.style},{default:n((()=>[u(l,{item:e},null,8,["item"])])),_:2},1032,["virtualIndex","custom-style"])))),128))])),_:1},8,["list","modules","virtualList"])])),_:1}),u(w,{title:"无限循环"},{default:n((()=>[u(g,{list:h.value,"onUpdate:list":s[1]||(s[1]=e=>h.value=e),loop:"",virtual:"",modules:t.value,virtualList:x.value},{default:n((()=>[(r(!0),o(p,null,c(h.value,((e,t)=>(r(),d(f,{key:t,virtualIndex:e.virtualIndex,"custom-style":e.props.style},{default:n((()=>[u(l,{item:e},null,8,["item"])])),_:2},1032,["virtualIndex","custom-style"])))),128))])),_:1},8,["list","modules","virtualList"])])),_:1})])),_:1})}}});export{h as default};
